[Definition]

# Log file for SSH login monitoring
logtarget = /var/log/fail2ban/ssh-login-monitor.log

# Action to initialize logging
actionstart = mkdir -p /var/log/fail2ban
              touch "<logtarget>"
#              echo "$(date '+%%Y-%%m-%%d %%H:%%M:%%S') [INFO] SSH Login Monitor started" >> "<logtarget>"

# Action to stop logging
actionstop =
#actionstop = echo "$(date '+%%Y-%%m-%%d %%H:%%M:%%S') [INFO] SSH Login Monitor stopped" >> "<logtarget>"

# Check if logging is available
actioncheck = test -w /var/log/fail2ban

# 使用正确的标签：<F-KEYTYPE> 和 <fingerprint>
actionban = /etc/fail2ban/action.d/log-ssh-keyname.sh "<ip>" "<F-USER>" "<F-FINGERPRINT>" "<F-KEYTYPE>"

# 空操作
actionunban =

[Init]
logtarget = /var/log/fail2ban/ssh-login-monitor.log